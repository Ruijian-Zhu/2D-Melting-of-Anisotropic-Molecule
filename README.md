# 2D-Melting-of-Anisotropic-Molecule

These C++ codes are used to analyze the two-dimensional phase transition of molecular systems. There are mainly four evaluated physical quantities: translational correlation function, bond-orientational correlation function, body-orientational order parameter (also the distribution of monomer body orientation), and the Voronoi analysis of topological defects. For the first quantity, we provide two different codes designed for rectangular box and triclinic box. All the input data are assumed to be generated by LAMMPS. Below we will describe each program in more detail.

The codes are developed by Ruijian Zhu, from Prof. Yanting Wang's research group (http://soft-matter.itp.ac.cn/) at Institute of Theoretical Physics, Chinese Academy of Sciences (ITP-CAS). Please contact the developer Ruijian Zhu (zhuruijian@itp.ac.cn) for questions.

### Reorder the COM trajectory

The analysis tool in LAMMPS can calculate the COM of each monomer and output as an independent file for each snapshot, whose example is given in the corresponding folder. To perform more analysis based on the time evolution of COMs (for most cases, these are also the representative points of unit-cells), we arrange them into a single LAMMPS trajectory file, which is realized by the corresponding c++ program. The c++ file with a suffix 'tilt' is modified for triclinic box.

### Calculate the translational correlation function

The calculation of translational correlation is separated into two steps: (1) Scannng $\theta$ at a fixed $r$ to find out the crystal axis; (2) Scanning over $r$ along the crystal axis to obtain the correlation function. The first step is performed by theta.cpp while the second step is performed by paircorre.cpp. The files with suffix 'tilt' are modified for triclinic box. A more detailed description on this procedure can be found in Y.-W. Li and M. P. Ciamarra, Phys. Rev. E 100, 062606 or [arXiv 2302.08305](https://arxiv.org/abs/2302.08305v3).

### Calculate the bond-orientational correlational function

The analysis tool in LAMMPS can calculate the bond-orietational order parameter related to each monomer, using the LAMMPS trajectory created in the first step as input, and output as an independent file for each snapshot. The c++ program here use these output files as well as the reorder trajectory as input, calculating the correlation as a function of $r$.

### Calculate the body-orientation

This program use both the original trajectory and the COM trajectory as inputs, so as to save the claculation time. 'body_theta.cpp' calculate the body-orientation while 'body_orient.cpp' calculate the corresponding order parameter, both taking n-fold rotational symmetry of monomer into account. This is designed for the ball-stick molecule we used in our research work [arXiv 2302.08305](https://arxiv.org/abs/2302.08305v3), but can be easily modified for other anisotropic molecules, e.g., the coordinate of each atom would be replaced by the one for the vertex when studying hard polygons.

### Voronoi diagram

Delauney tessellation/Voronoi diagram is a classical method to decide the topologically nearest neighbors of a point, which can be further used to define the topological defects. The two python programs we provided here are based on the freud library (https://freud.readthedocs.io/en/latest/) developed by Prof. Sharon C. Glotzer's group in Michigan University, which can easily perform Voronoi analysis taking PBC into account, and are modified for LAMMPS trajectory. More examples on the installation as well as the usage of freud library are refered to the notebook provided on Prof. Glotzer's personal homepage (https://nbviewer.org/github/harperic/freud-examples/blob/master/index.ipynb).

### Examples

In the folder 'example', we upload sample documents for both rectangular and triclinic box. There is a pdf file in each folder illustrating the relationship of relative files. It should be noticed that these files are just used as illustration of the input and output of the codes, produced from very short simulation without sufficient relaxation, so the results may be not strict for physics.

